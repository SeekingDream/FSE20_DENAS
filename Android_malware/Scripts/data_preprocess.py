import numpy as np
import pickle
from Android_malware.Scripts.utils import FEANUMDIC, NowYear


def construct_data(index_res, save_name):
    res = np.zeros([len(index_res), FEANUMDIC[NowYear]], dtype=np.bool)
    for i, index in enumerate(index_res):
        res[i][index] = 1
    np.save(save_name, res)


if __name__ == '__main__':
    with open('../data/2019/x_train_compress.pickle', 'rb') as f:
        x_train = pickle.load(f)
        construct_data(x_train, '../data/2019/x_train.npy')

    with open('../data/2019/x_test_compress.pickle', 'rb') as f:
        x_test = pickle.load(f)
        construct_data(x_test, '../data/2019/x_test.npy')

    with open('../data/2019/y_train_compress.pickle', 'rb') as f:
        y_train = pickle.load(f)
        np.save('../data/2019/y_train.npy', y_train)

    with open('../data/2019/y_test_compress.pickle', 'rb') as f:
        y_test = pickle.load(f)
        np.save('../data/2019/y_test.npy', y_test)